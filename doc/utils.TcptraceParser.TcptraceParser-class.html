<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>utils.TcptraceParser.TcptraceParser</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >Botnet Emulator</th>
          </tr></table></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="utils-module.html">Package&nbsp;utils</a> ::
        <a href="utils.TcptraceParser-module.html">Module&nbsp;TcptraceParser</a> ::
        Class&nbsp;TcptraceParser
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="utils.TcptraceParser.TcptraceParser-class.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== CLASS DESCRIPTION ==================== -->
<h1 class="epydoc">Class TcptraceParser</h1><p class="nomargin-top"><span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser">source&nbsp;code</a></span></p>
<pre class="base-tree">
object --+
         |
        <strong class="uidshort">TcptraceParser</strong>
</pre>

<hr />
<!-- ==================== INSTANCE METHODS ==================== -->
<a name="section-InstanceMethods"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Instance Methods</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-InstanceMethods"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="utils.TcptraceParser.TcptraceParser-class.html#__init__" class="summary-sig-name">__init__</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">outputdir</span>=<span class="summary-sig-default"><code class="variable-quote">'</code><code class="variable-string">/tmp/botnetemulator/tcptrace</code><code class="variable-quote">'</code></span>)</span><br />
      x.__init__(...) initializes x; see help(type(x)) for signature</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser.__init__">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="utils.TcptraceParser.TcptraceParser-class.html#plotConnectionStatisticsFromPcap" class="summary-sig-name">plotConnectionStatisticsFromPcap</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">pcaplocation</span>,
        <span class="summary-sig-arg">numBotsInIterations</span>=<span class="summary-sig-default">None</span>)</span><br />
      Creates plots that show the impact of a DDoS attack as seen from the given pcap files.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser.plotConnectionStatisticsFromPcap">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_collectFilesToAnalyse"></a><span class="summary-sig-name">_collectFilesToAnalyse</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">pcaplocation</span>)</span><br />
      Returns a list of files that shall be analysed by tcptrace
:param pcaplocation: The path to a directory containing files in pcap or pcapng format
            or the path to one such loc.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser._collectFilesToAnalyse">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_runTcpTraceOnPcap"></a><span class="summary-sig-name">_runTcpTraceOnPcap</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">pcapfile</span>)</span><br />
      Runs tcptrace -ln on the given pcap loc and returns the input</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser._runTcpTraceOnPcap">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="utils.TcptraceParser.TcptraceParser-class.html#_extractConnectionStatistics" class="summary-sig-name" onclick="show_private();">_extractConnectionStatistics</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">ttoutput</span>)</span><br />
      Extracts the communicating hosts, relative time of first packet and 
      duration for every tcp connection from the given output of tcptrace 
      -ln.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser._extractConnectionStatistics">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="utils.TcptraceParser.TcptraceParser-class.html#_createPlotOfLoadingTimes" class="summary-sig-name" onclick="show_private();">_createPlotOfLoadingTimes</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">connection_statistics</span>,
        <span class="summary-sig-arg">filename</span>)</span><br />
      Creates a pdf that shows a plot with the relative time when a page 
      load began on the x-axis and the time taken to complete the page load
      on the y-axis.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser._createPlotOfLoadingTimes">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="utils.TcptraceParser.TcptraceParser-class.html#_createPlotOfFailedConnections" class="summary-sig-name" onclick="show_private();">_createPlotOfFailedConnections</a>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">connection_statistics</span>,
        <span class="summary-sig-arg">outputdir</span>)</span><br />
      Creates a pdf that shows a plot with the relative time when a page 
      load began on the x-axis and the time taken to complete the page load
      on the y-axis.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser._createPlotOfFailedConnections">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_extractXAxis"></a><span class="summary-sig-name">_extractXAxis</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">connection_statistics</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser._extractXAxis">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_createCsvOfLoadingTimes"></a><span class="summary-sig-name">_createCsvOfLoadingTimes</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">connection_statistics</span>,
        <span class="summary-sig-arg">outputfile</span>,
        <span class="summary-sig-arg">numBotsInIterations</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser._createCsvOfLoadingTimes">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr class="private">
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="_createCsvOfSuccessfulConnections"></a><span class="summary-sig-name">_createCsvOfSuccessfulConnections</span>(<span class="summary-sig-arg">self</span>,
        <span class="summary-sig-arg">connection_statistics</span>,
        <span class="summary-sig-arg">outputfile</span>,
        <span class="summary-sig-arg">numBotsInIterations</span>,
        <span class="summary-sig-arg">countSuccessfulConnections</span>)</span></td>
          <td align="right" valign="top">
            <span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser._createCsvOfSuccessfulConnections">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__delattr__</code>,
      <code>__format__</code>,
      <code>__getattribute__</code>,
      <code>__hash__</code>,
      <code>__new__</code>,
      <code>__reduce__</code>,
      <code>__reduce_ex__</code>,
      <code>__repr__</code>,
      <code>__setattr__</code>,
      <code>__sizeof__</code>,
      <code>__str__</code>,
      <code>__subclasshook__</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== PROPERTIES ==================== -->
<a name="section-Properties"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Properties</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Properties"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
  <tr>
    <td colspan="2" class="summary">
    <p class="indent-wrapped-lines"><b>Inherited from <code>object</code></b>:
      <code>__class__</code>
      </p>
    </td>
  </tr>
</table>
<!-- ==================== METHOD DETAILS ==================== -->
<a name="section-MethodDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Method Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-MethodDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="__init__"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">__init__</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">outputdir</span>=<span class="sig-default"><code class="variable-quote">'</code><code class="variable-string">/tmp/botnetemulator/tcptrace</code><code class="variable-quote">'</code></span>)</span>
    <br /><em class="fname">(Constructor)</em>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser.__init__">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>x.__init__(...) initializes x; see help(type(x)) for signature</p>
  <dl class="fields">
    <dt>Overrides:
        object.__init__
        <dd><em class="note">(inherited documentation)</em></dd>
    </dt>
  </dl>
</td></tr></table>
</div>
<a name="plotConnectionStatisticsFromPcap"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">plotConnectionStatisticsFromPcap</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">pcaplocation</span>,
        <span class="sig-arg">numBotsInIterations</span>=<span class="sig-default">None</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser.plotConnectionStatisticsFromPcap">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <pre class="literalblock">
Creates plots that show the impact of a DDoS attack as seen from the given pcap files.
Extracts the communicating hosts, relative time of first packet and duration for every tcp connection
in the given directory and returns those statistics.
:param pcaplocation: The path to a directory containing files in pcap or pcapng format
        or the path to one such loc.
:param numBotsInIterations: Number of bots we have in each iteration. Needed to create CSV output. 
        CSV output will be omited if this parameter is missing or None.
:return: A list of TcpConnection objects ordered by the connection start time.

</pre>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_extractConnectionStatistics"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_extractConnectionStatistics</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">ttoutput</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser._extractConnectionStatistics">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Extracts the communicating hosts, relative time of first packet and 
  duration for every tcp connection from the given output of tcptrace -ln. 
  See loc testfiles/httpconnections.tcptrace for an example of what this 
  method parses. :type ttoutput: str :param ttoutput: The output that 
  tcptrace produced :return: A list of TcpConnection objects ordered by the
  connection start time.</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_createPlotOfLoadingTimes"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_createPlotOfLoadingTimes</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">connection_statistics</span>,
        <span class="sig-arg">filename</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser._createPlotOfLoadingTimes">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Creates a pdf that shows a plot with the relative time when a page 
  load began on the x-axis and the time taken to complete the page load on 
  the y-axis. Page load means that this sensor loads a web page from a web 
  server and measures how long this takes. :param connection_statistics: A 
  list of TcpConnection objects</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<a name="_createPlotOfFailedConnections"></a>
<div class="private">
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">_createPlotOfFailedConnections</span>(<span class="sig-arg">self</span>,
        <span class="sig-arg">connection_statistics</span>,
        <span class="sig-arg">outputdir</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="utils.TcptraceParser-pysrc.html#TcptraceParser._createPlotOfFailedConnections">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Creates a pdf that shows a plot with the relative time when a page 
  load began on the x-axis and the time taken to complete the page load on 
  the y-axis. Page load means that this sensor loads a web page from a web 
  server and measures how long this takes. :param connection_statistics: A 
  list of TcpConnection objects</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Project homepage -->
      <th class="navbar" align="right" width="100%">
        <table border="0" cellpadding="0" cellspacing="0">
          <tr><th class="navbar" align="center"
            >Botnet Emulator</th>
          </tr></table></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Sat Sep  3 13:57:56 2016
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
